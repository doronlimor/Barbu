html<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barbu - Card Game</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #062318 0%, #0a4d2e 50%, #0d5c38 100%);
            min-height: 100vh;
            color: white;
            padding: 10px;
        }
        .game-container { max-width: 1200px; margin: 0 auto; }
        .game-header {
            text-align: center;
            padding: 15px;
            margin-bottom: 15px;
            border-bottom: 2px solid #d4af37;
        }
        .game-title {
            font-size: 2.2em;
            color: #d4af37;
            margin-bottom: 5px;
        }
        .game-subtitle {
            font-size: 1em;
            color: #f4e4a6;
        }
        .message-box {
            background: rgba(0, 0, 0, 0.6);
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-size: 1em;
            border: 2px solid #d4af37;
        }
        .contract-selection {
            background: rgba(0, 0, 0, 0.5);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 2px solid #d4af37;
        }
        .contract-title { font-size: 1.8em; color: #d4af37; margin-bottom: 20px; text-align: center; }
        .contract-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .contract-button {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
            border: 2px solid #d4af37;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }
        .contract-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.4);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.3), rgba(212, 175, 55, 0.2));
        }
        .contract-name { font-size: 1.3em; font-weight: bold; margin-bottom: 8px; }
        .contract-description { font-size: 0.9em; color: #f4e4a6; line-height: 1.4; margin-bottom: 8px; }
        .game-info {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }
        .info-item { text-align: center; }
        .info-label { font-size: 0.9em; color: #f4e4a6; margin-bottom: 5px; }
        .info-value { font-size: 1.5em; font-weight: bold; color: #d4af37; }
        .action-button {
            background: linear-gradient(135deg, #d4af37, #c09a2e);
            border: none;
            border-radius: 10px;
            padding: 15px 40px;
            font-size: 1.2em;
            font-weight: bold;
            color: #062318;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        .action-button:hover { transform: translateY(-3px); box-shadow: 0 6px 25px rgba(212, 175, 55, 0.6); }
        .game-board {
            display: grid;
            grid-template-areas: 
                "opponent2 opponent2 opponent2"
                "opponent1 center opponent3"
                "player player player";
            gap: 10px;
            margin-bottom: 15px;
        }
        .player-area {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 12px;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }
        .player-area.dealer { border-color: #4169e1; box-shadow: 0 0 20px rgba(65, 105, 225, 0.4); }
        .player-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .player-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #d4af37;
        }
        .dealer-badge {
            background: #4169e1;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.7em;
            margin-left: 8px;
        }
        .player-score {
            font-size: 1.4em;
            font-weight: bold;
            color: #f4e4a6;
        }
        .cards-container {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            justify-content: center;
            min-height: 60px;
        }
        .card {
            width: 40px;
            height: 56px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .card.red { color: #dc143c; }
        .card.black { color: #1a1a1a; }
        .card-rank { font-size: 0.9em; font-weight: bold; margin-bottom: 2px; }
        .card-suit { font-size: 1.1em; }
        .card-back {
            width: 40px;
            height: 56px;
            background: linear-gradient(135deg, #1a237e 0%, #0d47a1 100%);
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.2);
            font-size: 1.5em;
        }
        #player0 .card { width: 70px; height: 98px; }
        #player0 .card-rank { font-size: 1.5em; }
        #player0 .card-suit { font-size: 1.8em; }
        #player0 .cards-container { gap: 6px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">Barbu</h1>
            <div class="game-subtitle">Classic Four-Player Card Game</div>
        </div>
        <div id="message" class="message-box">Initializing...</div>
        <div id="contractSelection" class="contract-selection hidden"></div>
        <div id="gamePlay" class="hidden"></div>
    </div>
    <script>
        console.log('Script starting...');
        
        var gameState = {
            round: 1,
            dealer: 0,
            players: [
                { name: 'You', cards: [], score: 0 },
                { name: 'Player 2', cards: [], score: 0 },
                { name: 'Player 3', cards: [], score: 0 },
                { name: 'Player 4', cards: [], score: 0 }
            ]
        };
        
        var SUITS = {
            HEARTS: { symbol: '♥', name: 'Hearts', color: 'red' },
            DIAMONDS: { symbol: '♦', name: 'Diamonds', color: 'red' },
            CLUBS: { symbol: '♣', name: 'Clubs', color: 'black' },
            SPADES: { symbol: '♠', name: 'Spades', color: 'black' }
        };
        
        var CONTRACTS = {
            NO_TRICKS: { name: 'No Tricks', description: 'Each trick = -2 points' },
            NO_HEARTS: { name: 'No Hearts', description: 'Each heart = -2, Ace = -6' },
            NO_QUEENS: { name: 'No Queens', description: 'Each queen = -6 points' },
            BARBU: { name: 'Barbu', description: 'King of hearts = -20 points' },
            LAST_TWO: { name: 'Last Two', description: 'Trick 12 = -10, Trick 13 = -20' },
            TRUMPS: { name: 'Trumps', description: 'Each trick = +5 points' },
            DOMINO: { name: 'Domino', description: '1st +45, 2nd +20, 3rd +5, 4th -5' }
        };
        
        function createDeck() {
            console.log('Creating deck...');
            var deck = [];
            var ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            for (var suitKey in SUITS) {
                for (var i = 0; i < ranks.length; i++) {
                    deck.push({ suit: suitKey, rank: ranks[i], id: ranks[i] + '_' + suitKey });
                }
            }
            for (var i = deck.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = deck[i];
                deck[i] = deck[j];
                deck[j] = temp;
            }
            console.log('Deck created with ' + deck.length + ' cards');
            return deck;
        }
        
        function dealCards() {
            console.log('Dealing cards...');
            var deck = createDeck();
            for (var i = 0; i < 4; i++) {
                gameState.players[i].cards = deck.slice(i * 13, (i + 1) * 13);
            }
            sortPlayerCards(0);
            console.log('Cards dealt. Player has ' + gameState.players[0].cards.length + ' cards');
        }
        
        function sortPlayerCards(playerIndex) {
            var suitOrder = { SPADES: 0, HEARTS: 1, CLUBS: 2, DIAMONDS: 3 };
            var rankValues = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, '10': 10, '9': 9, '8': 8, '7': 7, '6': 6, '5': 5, '4': 4, '3': 3, '2': 2 };
            
            gameState.players[playerIndex].cards.sort(function(a, b) {
                if (suitOrder[a.suit] !== suitOrder[b.suit]) {
                    return suitOrder[a.suit] - suitOrder[b.suit];
                }
                return rankValues[b.rank] - rankValues[a.rank];
            });
        }
        
        function showMessage(msg) {
            document.getElementById('message').textContent = msg;
        }
        
        function showCardsBeforeContract() {
            console.log('Showing cards before contract...');
            try {
                document.getElementById('contractSelection').classList.add('hidden');
                document.getElementById('gamePlay').classList.remove('hidden');
                
                showMessage('Round ' + gameState.round + ' - Review your cards');
                
                var html = '<div class="game-info">';
                html += '<div class="info-item"><div class="info-label">Round</div><div class="info-value">' + gameState.round + '/28</div></div>';
                html += '<div class="info-item"><div class="info-label">You are Dealer</div><div class="info-value">Choose Contract</div></div>';
                html += '</div>';
                
                html += '<div class="game-board">';
                html += '<div style="grid-area: opponent2" id="player2"></div>';
                html += '<div style="grid-area: opponent1" id="player1"></div>';
                html += '<div style="grid-area: center; display:flex; align-items:center; justify-content:center;">';
                html += '<div style="text-align:center;padding:40px;color:#d4af37;font-size:1.3em;">Review your cards, then select a contract below</div>';
                html += '</div>';
                html += '<div style="grid-area: opponent3" id="player3"></div>';
                html += '<div style="grid-area: player" id="player0"></div>';
                html += '</div>';
                
                html += '<div style="text-align:center;margin-top:20px;">';
                html += '<button class="action-button" onclick="showContractSelection()">Choose Contract</button>';
                html += '</div>';
                
                document.getElementById('gamePlay').innerHTML = html;
                
                for (var i = 0; i < 4; i++) {
                    var container = document.getElementById('player' + i);
                    var player = gameState.players[i];
                    var isDealer = i === gameState.dealer;
                    
                    var playerHtml = '<div class="player-area' + (isDealer ? ' dealer' : '') + '">';
                    playerHtml += '<div class="player-info">';
                    playerHtml += '<div class="player-name">' + player.name;
                    if (isDealer) playerHtml += '<span class="dealer-badge">Dealer</span>';
                    playerHtml += '</div>';
                    playerHtml += '<div class="player-score">' + player.score + '</div>';
                    playerHtml += '</div>';
                    playerHtml += '<div class="cards-container">';
                    
                    for (var j = 0; j < player.cards.length; j++) {
                        var card = player.cards[j];
                        if (i === 0) {
                            var suit = SUITS[card.suit];
                            playerHtml += '<div class="card ' + suit.color + '">';
                            playerHtml += '<div class="card-rank">' + card.rank + '</div>';
                            playerHtml += '<div class="card-suit">' + suit.symbol + '</div>';
                            playerHtml += '</div>';
                        } else {
                            playerHtml += '<div class="card-back">♠</div>';
                        }
                    }
                    
                    playerHtml += '</div></div>';
                    container.innerHTML = playerHtml;
                }
                
                console.log('Cards displayed successfully');
            } catch (e) {
                console.error('Error showing cards:', e);
                showMessage('Error: ' + e.message);
            }
        }
        
        function showContractSelection() {
            console.log('Showing contract selection...');
            document.getElementById('gamePlay').classList.add('hidden');
            document.getElementById('contractSelection').classList.remove('hidden');
            
            showMessage('Round ' + gameState.round + ' - Choose your contract');
            
            var html = '<h2 class="contract-title">Choose Contract</h2>';
            html += '<div class="contract-grid">';
            
            for (var key in CONTRACTS) {
                var contract = CONTRACTS[key];
                html += '<div class="contract-button" onclick="alert(\'Selected: ' + contract.name + '\')">';
                html += '<div class="contract-name">' + contract.name + '</div>';
                html += '<div class="contract-description">' + contract.description + '</div>';
                html += '</div>';
            }
            
            html += '</div>';
            document.getElementById('contractSelection').innerHTML = html;
        }
        
        function startGame() {
            console.log('Starting game...');
            try {
                showMessage('Dealing cards...');
                dealCards();
                showMessage('Cards dealt!');
                showCardsBeforeContract();
            } catch (e) {
                console.error('Error starting game:', e);
                showMessage('Error starting game: ' + e.message);
            }
        }
        
        window.showContractSelection = showContractSelection;
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', startGame);
        } else {
            startGame();
        }
        
        console.log('Script loaded successfully');
    </script>
</body>
</html>
